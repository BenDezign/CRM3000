{% import 'extra/macros/helper_facture.html.twig' as helper %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>{{ 'facture.label'|trans }} N° {{ facture.id }}</title>
    <style type="text/css">
        @import url(https://fonts.googleapis.com/css?family=Montserrat:400,700);

        .clearfix:after {
            content: "";
            display: table;
            clear: both;
        }

        a {
            color: #4e5f7a;
            text-decoration: none;
        }

        html, body {
            position: relative;
            width: 21cm;
            /*height: 29.7cm;*/
            height: 34.5cm;
            margin: 0 auto;
            color: #555555;
            background: #FFFFFF;
            /*  font-family: Arial, sans-serif; */
            font-size: 12px;
            font-family: 'Montserrat', sans-serif;
        }

        header {
            padding: 10px 0;
            margin-bottom: 20px;
            border-bottom: 1px solid #AAAAAA;
        }

        #logo {
            float: left;
            margin-top: 8px;
        }

        #logo img {
            /* height: 70px;*/
            width: 200px;
        }

        #company {
            float: right;
            text-align: right;
            /*margin-top: 50px;*/
            margin-top: 20px;
        }

        .text-center {
            text-align: center !important;
        }

        .text-right {
            text-align: right !important;
        }

        .text-left {
            text-align: left !important;
        }


        #details {
            margin-bottom: 50px;
        }

        .details_top {
            margin-bottom: 20px;
        }

        #client {
            padding-left: 6px;
            border-left: 6px solid #4e5f7a;
            float: left;
        }

        #site {
            /*clear: left;*/
            padding-left: 6px;
            margin-left: 2px;
            border-left: 6px solid #8b9dac;
            float: left;
        }

        #site .to {
            color: #777777;
        }

        #client .to {
            color: #777777;
        }

        h2.name {
            font-size: 1.4em;
            font-weight: normal;
            margin: 0;
        }

        #invoice {
            float: right;
            text-align: right;
        }

        #invoice h1 {
            color: #4e5f7a;
            font-size: 2.4em;
            line-height: 1em;
            font-weight: normal;
            margin: 0 0 10px 0;
        }

        #invoice .date {
            font-size: 1.1em;
            color: #777777;
        }

        table {
            width: 100%;
            border-collapse: collapse;
            border-spacing: 0;
            margin-bottom: 20px;
        }

        table th,
        table td {
            padding: 5px;
            background: #EEEEEE;
            text-align: center;
            border-bottom: 1px solid #FFFFFF;
        }

        table th {
            white-space: nowrap;
            font-weight: normal;
        }

        .th-header {
            background-color: #4e5f7a;
            color: white;
        }

        table td {
            text-align: right;
        }

        table td h3 {
            color: #4e5f7a;
            font-size: 1.2em;
            font-weight: normal;
            margin: 0 0 0.2em 0;
        }

        .bg-grey {
            background: #EEEEEE;
        }

        .bg-grey-dark {
            background: rgba(221, 221, 221, 0.7);
        }

        table .no {
            color: #FFFFFF;
            font-size: 1.6em;
            background: #4e5f7a;
            text-align: center;
        }

        table .detail {
            padding: 0px 15px;
            font-size: 0.9em;
        }

        table .no.detail, table .total.detail {
            background: rgba(78, 95, 122, 0.7);
        }

        table .desc.detail {
            background: rgba(238, 238, 238, 0.7);
        }

        table .unit.detail {
            background: rgba(221, 221, 221, 0.7);
        }

        table .desc {
            text-align: left;
        }

        table .unit {
            background: #DDDDDD;
        }

        table .qty {
        }

        table .total {
            background: #4e5f7a;
            color: #FFFFFF;
        }

        table td.unit,
        table td.qty,
        table td.total {
            font-size: 0.9em;
        }

        table tbody tr:last-child td {
            /*border: none;*/
        }

        table tfoot td {
            padding: 10px 20px;
            background: #FFFFFF;
            border-bottom: none;
            font-size: 0.9em;
            white-space: nowrap;
            /*border-top: 1px solid #AAAAAA;*/
        }

        table tfoot tr:first-child td {
            /*border-top: none;*/
        }

        table tfoot tr:last-child td {
            /*color: #4e5f7a;*/
            /*font-size: 1em;*/
            /*border-top: 1px solid #4e5f7a;*/

        }

        table tfoot tr td:first-child {
            /*border: none;*/
        }

        #thanks {
            font-size: 1.25em;
            margin-bottom: 10px;
        }

        #notices {
            padding-left: 6px;
            border-left: 6px solid #4e5f7a;
        }


        #notices .notice {
            font-size: 1.2em;
        }

        footer {
            color: #777777;
            display: inline-table;
            width: 100%;
            height: 30px;
            position: absolute;
            bottom: 0;
            border-top: 1px solid #AAAAAA;
            padding: 8px 0;
            text-align: center;
            font-size: 1em;
        }

        .blue {
            color: blue;
        }

        .m-1 {
            margin: 1%;
        }

        .m-2 {
            margin: 2%;
        }

        .clearfix-light {
            margin-bottom: 20px;
        }

        .border-left-white {
            border-left: 1px solid white !important;
        }

        .border-top-black {
            border-top: 1px solid black !important;;
        }

        .border-top-blue {
            border-top: 1px solid #4e5f7a !important;;
        }

        .border-bottom-black {
            border-bottom: 1px solid black !important;;
        }

        .border-bottom-blue {
            border-bottom: 1px solid #4e5f7a !important;;
        }

        .block_blue {
            background-color: #4e5f7a;
            color: white;
        }

        .w-large {
            width: 50%;
        }

        .w-small {
            width: 1%;
        }

        .big_font_size {
            font-size: 20px;
        }

    </style>
</head>
<body>
<header class="clearfix">
    <div id="logo">
        <img src="https://img.mailinblue.com/4190408/images/rnb/original/618711c163ca37287f34ee71.png">
    </div>
    <div id="company">
        <h2 class="name blue">{{ getEnv('APP_NAME') }}</h2>
        <div>{{ getEnv('ADDR_SOC') }}</div>
        <div>{{ getEnv('CP_SOC') }} ,{{ getEnv('VILLE_SOC') }}</div>
        <div>{{ getEnv('EMAIL_SOC') }}</div>
        <div>{{ getEnv('TEL_SOC') }}</div>

    </div>
</header>
<main>
    <div id="details">
        <div id="client" class="clearfix-light">
            <div class="to">{{ 'facture.to'|trans }} :</div>
            <h2 class="name"> {{ facture.company.name }}</h2>
            <div class="address">
                {{ facture.company.address }}<br />
                {{ facture.company.zipCode }}
                {{ facture.company.city }}
            </div>
        </div>
        <div id="invoice">
            <h1>{{ 'facture.label'|trans }} n° {{ facture.id }}</h1>

            <div class="date">Paris , le {{ facture.createdAt|date('d/m/Y') }}<br/></div>

        </div>
    </div>
    <table width="100%"></table>
    {{'find_element'|trans}}

    {% set sous_total1 =  0 %}

    {% set sous_total_ht_1 = 0 %}



    {% set sous_total_tva_1 = 0 %}




    <table border="0" cellspacing="0" cellpadding="0" width="100%">
        {{helper.header(facture.assujettiTva)}}
        <tbody>

        {% set total_qtt =  0 %}
        {% for facturation in facture.factureDetails %}



            {% set sous_total_ht_1 = sous_total_ht_1+ facturation.qtt * facturation.pu %}

            {% if facture.assujettiTva %}
                {% set sous_total_tva_1 = sous_total_tva_1 + facturation.montantTva %}
                {% set sous_total1 = sous_total_ht_1 + sous_total_tva_1 %}
                {% set total =  facturation.qtt * facturation.pu %}
                {% set total_qtt =  total_qtt + facturation.qtt %}
            {% else %}
                {% set sous_total1 = sous_total1 + facturation.qtt * facturation.pu %}
                {% set total =  facturation.qtt * facturation.pu %}
                {% set total_qtt =  total_qtt +facturation.qtt %}
            {% endif %}

            {{ helper.corps(facturation , facture.assujettiTva) }}


        {% endfor %}
        </tbody>

        {{ helper.footer(facture.assujettiTva , sous_total_ht_1 , 1) }}
    </table>


    <hr>
    <table border="0" cellspacing="0" cellpadding="0" width="100%">
        <tfoot>
        <tr>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td></td>
            <td><strong>{{ 'sous_total'|trans|upper }}</strong></td>
            {% if facture.assujettiTva  %}
                <td>{{ prettyPrices(sous_total_ht_1)|raw }}</td>
            {% else %}
                <td>{{ prettyPrices(sous_total1)|raw }}</td>
            {% endif %}
        </tr>
        {% if facture.assujettiTva %}

            {% for key,diffTva in facture.getDiffTotalTva %}
                <tr>
                    <td colspan="2"></td>
                    <td colspan="2"></td>
                    <td></td>
                    <td><strong>{{ 'total_tva'|trans|upper }}  {{ key }} % :</strong></td>

                    <td>{{ prettyPrices(diffTva)|raw }}</td>

                </tr>
            {% endfor %}
        {% endif %}
        <tr>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td></td>
            <td><strong>{{ 'total_ttc'|trans|upper }} :</strong></td>
            <td>{{ prettyPrices(sous_total1)|raw }}</td>
        </tr>
        <tr>
            <td colspan="2"></td>
            <td colspan="2"></td>
            <td class="w-large"></td>
            <td class="block_blue w-small big_font_size"><strong>{{ 'net_a_payer'|trans|upper }} : </strong></td>
            <td class="block_blue big_font_size">{{ prettyPrices(sous_total1)|raw }}</td>

        </tr>
        </tfoot>
    </table>

    <div id="thanks">
        L'équipe {{getEnv('APP_NAME')}} vous remercie de nous avoir fait confiance.
    </div>
</main>


</body>
</html>

